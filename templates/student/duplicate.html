{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Dashboard - Placement Portal</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
   <style>
        .dashboard-page { display: none; }
        .dashboard-page.active { display: block; }
        .job-card .card-body { padding: 1.25rem; }
        #topbarAvatar { position: relative; overflow: hidden; }
        #topbarAvatar img.avatar-photo { position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover; display: block; }
    </style>
</head>
<body>
    <div class="sidebar-wrapper">
        <!-- Overlay for mobile sidebar -->
        <div class="sidebar-overlay" id="sidebarOverlay" aria-hidden="true"></div>

        <!-- Left Sidebar -->
        <aside class="sidebar" id="sidebar" role="navigation" aria-label="Main navigation">
            <div class="sidebar-header">
                <h3><i class="fas fa-briefcase"></i>Placement Portal</h3>
            </div>
            <nav class="sidebar-nav">
                <ul class="sidebar-menu">
                    <li>
                        <a href="#" class="nav-link-dashboard active" data-page="page-dashboard">
                            <i class="fas fa-home"></i>Dashboard
                        </a>
                    </li>
                    <li>
                        <a href="#" class="nav-link-dashboard" data-page="page-personal-details">
                            <i class="fas fa-user-edit"></i>Update Personal Details
                        </a>
                    </li>
                    <li>
                        <a href="#" class="nav-link-dashboard" data-page="page-job-listings">
                            <i class="fas fa-briefcase"></i>New Job Listings
                        </a>
                    </li>
                    <li>
                        <a href="#" class="nav-link-dashboard" data-page="page-applied-jobs">
                            <i class="fas fa-file-alt"></i>Applied Jobs
                        </a>
                    </li>
                    <li>
                        <a href="#" class="nav-link-dashboard" data-page="page-shortlisted-companies">
                          <i class="fas fa-calendar-check"></i>Shortlisted Companies
                        </a>
                      </li>
                      
                    <li>
                        <a href="#" class="nav-link-dashboard" data-page="page-selected-companies">
                            <i class="fas fa-check-circle"></i>Selected Companies
                        </a>
                    </li>
                    <li>
                        <a href="#" class="nav-link-dashboard" data-page="page-placement-contact">
                            <i class="fas fa-address-card"></i>Placement Cell Contact
                        </a>
                    </li>
                </ul>
            </nav>
            <div class="sidebar-footer">
                <ul class="sidebar-menu">
                    <li>
                        <a href="{% url 'student_logout' %}"><i class="fas fa-sign-out-alt"></i>Logout</a>
                    </li>
                </ul>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Topbar -->
            <div class="topbar">
                <div>
                    <button class="mobile-menu-toggle" type="button" aria-label="Toggle menu">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 class="d-inline ms-3 mb-0 fs-4 fw-bold" id="page-title">Dashboard</h1>
                </div>
                <div class="user-profile">
                    <div class="text-end">
                        <strong id="topbarName">{{ user.first_name|upper }} {{ user.last_name|upper }}</strong><br>
                        <small class="text-muted" id="topbarBranch">{{ profile.course }}</small>
                    </div>
                    <div class="user-avatar" id="topbarAvatar">
                        {% if profile.passport_photo %}
                        <img src="{{ profile.passport_photo.url }}"
                            alt="Profile Photo"
                            style="width:100%;height:100%;object-fit:cover;">
                        {% else %}
                            {{ user.first_name|slice:"1"|upper }}
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- ========== DASHBOARD PAGE ========== -->
            <div id="page-dashboard" class="dashboard-page active">
                <!-- Greeting -->
                <div class="mb-4">
                    <h1 class="dashboard-greeting" id="studentGreeting">Good Morning, {{ user.first_name|upper }} {{ user.last_name|upper }}</h1>
                    <p class="dashboard-greeting-sub">Here’s your placement activity at a glance.</p>
                </div>

                <div class="row mb-4">
                    <div class="col-lg-4 mb-4">
                        <div class="card student-profile-card h-100">
                            <div class="card-header">
                                <h5 class="mb-0 fw-semibold"><i class="fas fa-user me-2 text-primary"></i>Student Profile</h5>
                            </div>
                            <div class="card-body">
                                <p class="mb-2"><strong>Name:</strong> <span id="profileCardName">{{ user.first_name }} {{ user.last_name }}</span></p>
                                <p class="mb-2"><strong>Email:</strong> <span id="profileCardEmail">{{ user.email }}</span></p>
                                <p class="mb-2"><strong>Phone Number:</strong> <span id="profileCardPhone">+91 {{ profile.phone }}</span></p>
                                <p class="mb-2"><strong>DOB:</strong> <span id="profileCardDob">{{ profile.dob }}</span></p>
                                <p class="mb-2"><strong>Gender:</strong> <span id="profileCardGender">{{ profile.gender }}</span></p>
                                <p class="mb-2"><strong>Course:</strong> <span id="profileCardCourse">{{ profile.course }}</span></p>
                                <p class="mb-2"><strong>Year:</strong> <span id="profileCardYear">{{ profile.year }}</span></p>
                                <p class="mb-2"><strong>Roll No:</strong> <span id="profileCardStudentId">{{ profile.enroll_number }}</span></p>
                                <p class="mb-2"><strong>CGPA:</strong> <span id="profileCardCgpa">{{ profile.cgpa }}</span> / 10</p>
                                <p class="mb-2"><strong>Skills:</strong> <span id="profileCardSkills">{{ profile.skills }}</span></p>
                                <p class="mb-2"><strong>LinkedIn:</strong> <span id="profileCardLinkedin">{{ profile.linkedin }}</span></p>
                                <p class="mb-2"><strong>GitHub:</strong> <span id="profileCardGithub">{{ profile.github }}</span></p>
                                <p class="mb-2"><strong>Portfolio:</strong> <span id="profileCardPortfolio">{{profile.portfolio }}</span></p>
                                <!-- <p class="mb-3"><strong>Resume:</strong> <span id="profileCardResume">{{profile.resume }}</span></p> -->
                        
                                <a href="{{ profile.resume.url }}" class="btn btn-primary w-100" id="profileResumeBtn">
                                    <i class="fas fa-file-pdf me-2"></i>Resume View
                                </a>
                               
            
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-8">
                        <div class="row mb-4">
                            <div class="col-md-4 mb-4">
                                <div class="stat-card">
                                    <i class="fas fa-file-alt fa-2x mb-2"></i>
                                    <h3>8</h3>
                                    <p>Jobs Applied</p>
                                </div>
                            </div>
                            <div class="col-md-4 mb-4">
                                <div class="stat-card warning">
                                    <i class="fas fa-phone-alt fa-2x mb-2"></i>
                                    <h3>3</h3>
                                    <p>Interview Calls</p>
                                </div>
                            </div>
                            <div class="col-md-4 mb-4">
                                <div class="stat-card success">
                                    <i class="fas fa-check-circle fa-2x mb-2"></i>
                                    <h3>1</h3>
                                    <p>Selected Companies</p>
                                </div>
                            </div>
                        </div>
                        <!-- Recent activity timeline -->
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0 fw-semibold"><i class="fas fa-stream me-2"></i>Recent Activity</h5>
                            </div>
                            <div class="card-body">
                                <ul class="activity-timeline">
                                    <li class="timeline-selected">
                                        <span class="timeline-time">22 Jan 2024</span>
                                        <span class="badge badge-selected"><i class="fas fa-check-circle"></i> Selected</span>
                                        <span class="timeline-desc d-block mt-1">Data Labs — Python Developer. Offer received.</span>
                                    </li>
                                    <li class="timeline-shortlisted">
                                        <span class="timeline-time">21 Jan 2024</span>
                                        <span class="badge badge-pending"><i class="fas fa-clock"></i> Under Review</span>
                                        <span class="timeline-desc d-block mt-1">Innovate Ltd — Frontend Developer. Interview scheduled.</span>
                                    </li>
                                    <li class="timeline-applied">
                                        <span class="timeline-time">19 Jan 2024</span>
                                        <span class="badge badge-applied"><i class="fas fa-paper-plane"></i> Applied</span>
                                        <span class="timeline-desc d-block mt-1">Cloud Solutions — Backend Developer.</span>
                                    </li>
                                    <li class="timeline-applied">
                                        <span class="timeline-time">16 Jan 2024</span>
                                        <span class="badge badge-applied"><i class="fas fa-paper-plane"></i> Applied</span>
                                        <span class="timeline-desc d-block mt-1">Tech Corp — Software Engineer.</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ========== UPDATE PERSONAL DETAILS PAGE ========== -->
            <div id="page-personal-details" class="dashboard-page">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="fas fa-user-edit me-2"></i>Update Personal Details</h5>
                    </div>
                    <div class="card-body">
                        <form id="personalDetailsForm">
                            <!-- Personal Information -->
                            <div class="form-section">
                                <h6 class="form-section-title"><i class="fas fa-user"></i> Personal Information</h6>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group-floating input-with-icon">
                                            <i class="fas fa-user input-icon" aria-hidden="true"></i>
                                            <input type="text" class="form-control" id="studentFirstName" name="firstName" placeholder=" " required>
                                            <label class="form-floating-label" for="studentFirstName">First Name <span class="text-danger">*</span></label>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group-floating input-with-icon">
                                            <i class="fas fa-user input-icon" aria-hidden="true"></i>
                                            <input type="text" class="form-control" id="studentLastName" name="lastName" placeholder=" ">
                                            <label class="form-floating-label" for="studentLastName">Last Name</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group-floating input-with-icon">
                                            <i class="fas fa-envelope input-icon" aria-hidden="true"></i>
                                            <input type="email" class="form-control" id="studentEmail" name="email" placeholder=" " required>
                                            <label class="form-floating-label" for="studentEmail">Email <span class="text-danger">*</span></label>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group-floating input-with-icon">
                                            <i class="fas fa-phone input-icon" aria-hidden="true"></i>
                                            <input type="tel" class="form-control" id="studentPhone" name="phone" placeholder=" " required>
                                            <label class="form-floating-label" for="studentPhone">Phone <span class="text-danger">*</span></label>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label" for="studentDob"><i class="fas fa-calendar me-1 text-muted"></i>Date of Birth</label>
                                            <input type="date" class="form-control" id="studentDob" name="dob">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label" for="studentGender"><i class="fas fa-venus-mars me-1 text-muted"></i>Gender</label>
                                            <select class="form-select" id="studentGender" name="gender">
                                                <option value="">Select gender</option>
                                                <option value="Male">Male</option>
                                                <option value="Female">Female</option>
                                                <option value="Other">Other</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label"><i class="fas fa-camera me-1"></i> Passport Size Photo</label>
                                    <div class="d-flex align-items-center gap-3">
                                        <div class="passport-photo-preview rounded-circle overflow-hidden bg-light border position-relative" id="passportPhotoPreview" style="width:80px;height:80px;min-width:80px;flex-shrink:0;">
                                            <i class="fas fa-user fa-2x text-muted position-absolute top-50 start-50 translate-middle" id="passportPhotoPlaceholder" style="z-index:0;"></i>
                                            <img id="passportPhotoImg" src="" alt="Photo" class="position-absolute top-0 start-0 w-100 h-100" style="object-fit:cover;display:none;z-index:1;">
                                        </div>
                                        <input type="file" class="form-control" id="studentPassportPhoto" name="passportPhoto" accept="image/jpeg,image/jpg,image/png" style="max-width:220px;">
                                    </div>
                                    <small class="text-muted">JPG or PNG, max 500KB</small>
                                </div>
                            </div>
                            <!-- Academic Info -->
                            <div class="form-section">
                                <h6 class="form-section-title"><i class="fas fa-graduation-cap"></i> Academic Info</h6>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label" for="studentCourse"><i class="fas fa-book me-1 text-muted"></i>Course</label>
                                            <select class="form-select" id="studentCourse" name="course">
                                                <option value="">Select course</option>
                                                <option value="CSE">CSE</option>
                                                <option value="IT">IT</option>
                                                <option value="ECE">ECE</option>
                                                <option value="Mechanical">Mechanical</option>
                                                <option value="Electrical">Electrical</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label" for="studentYear"><i class="fas fa-calendar-alt me-1 text-muted"></i>Year</label>
                                            <select class="form-select" id="studentYear" name="year">
                                                <option value="">Select year</option>
                                                <option value="First Year">First Year</option>
                                                <option value="Second Year">Second Year</option>
                                                <option value="Third Year">Third Year</option>
                                                <option value="Final Year">Final Year</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group-floating input-with-icon">
                                    <i class="fas fa-id-card input-icon" aria-hidden="true"></i>
                                    <input type="text" class="form-control" id="studentId" name="studentId" placeholder=" ">
                                    <label class="form-floating-label" for="studentId">Student ID / Roll Number</label>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group-floating input-with-icon">
                                            <i class="fas fa-chart-line input-icon" aria-hidden="true"></i>
                                            <input type="number" min="0" max="10" step="0.01" class="form-control" id="studentCgpa" name="cgpa" placeholder=" " required>
                                            <label class="form-floating-label" for="studentCgpa">CGPA <span class="text-danger">*</span></label>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group-floating input-with-icon">
                                            <i class="fas fa-code input-icon" aria-hidden="true"></i>
                                            <input type="text" class="form-control" id="studentSkills" name="skills" placeholder=" ">
                                            <label class="form-floating-label" for="studentSkills">Skills (comma-separated)</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Profile & Links -->
                            <div class="form-section">
                                <h6 class="form-section-title"><i class="fas fa-link"></i> Profile & Links</h6>
                                <div class="form-group-floating input-with-icon">
                                    <i class="fas fa-linkedin input-icon" aria-hidden="true"></i>
                                    <input type="url" class="form-control" id="studentLinkedin" name="linkedin" placeholder=" ">
                                    <label class="form-floating-label" for="studentLinkedin">LinkedIn Profile</label>
                                </div>
                                <div class="form-group-floating input-with-icon">
                                    <i class="fas fa-github input-icon" aria-hidden="true"></i>
                                    <input type="url" class="form-control" id="studentGithub" name="github" placeholder=" ">
                                    <label class="form-floating-label" for="studentGithub">GitHub Profile</label>
                                </div>
                                <div class="form-group-floating input-with-icon">
                                    <i class="fas fa-globe input-icon" aria-hidden="true"></i>
                                    <input type="url" class="form-control" id="studentPortfolio" name="portfolio" placeholder=" ">
                                    <label class="form-floating-label" for="studentPortfolio">Portfolio Website</label>
                                </div>
                            </div>
                            <!-- Resume -->
                            <div class="form-section">
                                <h6 class="form-section-title"><i class="fas fa-file-pdf"></i> Resume</h6>
                                <div class="file-drop-zone" id="resumeDropZone" role="button" tabindex="0">
                                    <input type="file" class="file-drop-input" id="resumeUpload" name="resume" accept=".pdf,application/pdf" aria-label="Upload resume PDF">
                                    <i class="fas fa-cloud-upload-alt file-drop-icon" aria-hidden="true"></i>
                                    <span class="file-drop-text">Drop your resume here or click to upload</span>
                                    <span class="file-drop-hint">PDF only, max 2MB</span>
                                    <span class="file-name" id="resumeFileName"></span>
                                </div>
                            </div>
                            <!-- Password (optional change) -->
                            <div class="form-section">
                                <h6 class="form-section-title"><i class="fas fa-lock"></i> Change Password</h6>
                                <p class="text-muted small mb-2">Leave blank to keep current password.</p>
                                <div class="form-group-floating input-with-icon">
                                    <i class="fas fa-lock input-icon" aria-hidden="true"></i>
                                    <input type="password" class="form-control" id="studentNewPassword" name="newPassword" placeholder=" " autocomplete="new-password">
                                    <label class="form-floating-label" for="studentNewPassword">New Password</label>
                                </div>
                                <div class="form-group-floating input-with-icon">
                                    <i class="fas fa-lock input-icon" aria-hidden="true"></i>
                                    <input type="password" class="form-control" id="studentConfirmPassword" name="confirmPassword" placeholder=" " autocomplete="new-password">
                                    <label class="form-floating-label" for="studentConfirmPassword">Confirm New Password</label>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary btn-hover-ripple">
                                <i class="fas fa-save me-2"></i>Save Changes
                            </button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- ========== NEW JOB LISTINGS PAGE ========== -->
            <div id="page-job-listings" class="dashboard-page">
                <div class="filter-bar">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <label class="form-label mb-0 me-2">Filter by Job Role:</label>
                        </div>
                        <div class="col-md-6">
                            <select class="form-select form-select-sm" id="jobRoleFilter">
                                <option value="">All Roles</option>
                                <option value="python">Python</option>
                                <option value="java">Java</option>
                                <option value="web">Web</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="row" id="jobListingsContainer">
                    <div class="col-md-6 col-lg-4 mb-4 job-card-item" data-role="python">
                        <div class="card job-card h-100">
                            <div class="card-body">
                                <h6 class="text-primary mb-2">Tech Corp</h6>
                                <h5 class="card-title mb-2">Python Developer</h5>
                                <p class="text-muted small mb-3"><strong>Eligibility:</strong> CGPA ≥ 7.5, Python, SQL</p>
                                <div class="d-flex gap-2">
                                    <button class="btn btn-sm btn-outline-primary flex-grow-1 view-job-details btn-hover-ripple" data-job-id="1" data-job-title="Python Developer" data-company="Tech Corp">View Details</button>
                                    <a href="#" class="btn btn-sm btn-primary flex-grow-1 apply-job-btn btn-hover-ripple" data-job-id="1" data-job-title="Python Developer">Apply</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-4 mb-4 job-card-item" data-role="java">
                        <div class="card job-card h-100">
                            <div class="card-body">
                                <h6 class="text-primary mb-2">Innovate Ltd</h6>
                                <h5 class="card-title mb-2">Java Backend Developer</h5>
                                <p class="text-muted small mb-3"><strong>Eligibility:</strong> CGPA ≥ 7.0, Java, Spring</p>
                                <div class="d-flex gap-2">
                                    <button class="btn btn-sm btn-outline-primary flex-grow-1 view-job-details btn-hover-ripple" data-job-id="1" data-job-title="Python Developer" data-company="Tech Corp">View Details</button>
                                    <a href="#" class="btn btn-sm btn-primary flex-grow-1 apply-job-btn btn-hover-ripple" data-job-id="1" data-job-title="Python Developer">Apply</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-4 mb-4 job-card-item" data-role="web">
                        <div class="card job-card h-100">
                            <div class="card-body">
                                <h6 class="text-primary mb-2">Cloud Solutions</h6>
                                <h5 class="card-title mb-2">Web Developer (React)</h5>
                                <p class="text-muted small mb-3"><strong>Eligibility:</strong> CGPA ≥ 7.0, HTML/CSS, JavaScript, React</p>
                                <div class="d-flex gap-2">
                                    <button class="btn btn-sm btn-outline-primary flex-grow-1 view-job-details btn-hover-ripple" data-job-id="1" data-job-title="Python Developer" data-company="Tech Corp">View Details</button>
                                    <a href="#" class="btn btn-sm btn-primary flex-grow-1 apply-job-btn btn-hover-ripple" data-job-id="1" data-job-title="Python Developer">Apply</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-4 mb-4 job-card-item" data-role="python">
                        <div class="card job-card h-100">
                            <div class="card-body">
                                <h6 class="text-primary mb-2">Data Labs</h6>
                                <h5 class="card-title mb-2">Python / Data Engineer</h5>
                                <p class="text-muted small mb-3"><strong>Eligibility:</strong> CGPA ≥ 7.5, Python, SQL, Pandas</p>
                                <div class="d-flex gap-2">
                                    <button class="btn btn-sm btn-outline-primary flex-grow-1 view-job-details btn-hover-ripple" data-job-id="1" data-job-title="Python Developer" data-company="Tech Corp">View Details</button>
                                    <a href="#" class="btn btn-sm btn-primary flex-grow-1 apply-job-btn btn-hover-ripple" data-job-id="1" data-job-title="Python Developer">Apply</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-4 mb-4 job-card-item" data-role="java">
                        <div class="card job-card h-100">
                            <div class="card-body">
                                <h6 class="text-primary mb-2">Finance Corp</h6>
                                <h5 class="card-title mb-2">Java Full Stack</h5>
                                <p class="text-muted small mb-3"><strong>Eligibility:</strong> CGPA ≥ 7.0, Java, Angular/React</p>
                                <div class="d-flex gap-2">
                                    <button class="btn btn-sm btn-outline-primary flex-grow-1 view-job-details btn-hover-ripple" data-job-id="1" data-job-title="Python Developer" data-company="Tech Corp">View Details</button>
                                    <a href="#" class="btn btn-sm btn-primary flex-grow-1 apply-job-btn btn-hover-ripple" data-job-id="1" data-job-title="Python Developer">Apply</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 col-lg-4 mb-4 job-card-item" data-role="web">
                        <div class="card job-card h-100">
                            <div class="card-body">
                                <h6 class="text-primary mb-2">Digital Innovations</h6>
                                <h5 class="card-title mb-2">Frontend Developer</h5>
                                <p class="text-muted small mb-3"><strong>Eligibility:</strong> CGPA ≥ 6.5, HTML/CSS, JS, React/Vue</p>
                                <div class="d-flex gap-2">
                                    <button class="btn btn-sm btn-outline-primary flex-grow-1 view-job-details btn-hover-ripple" data-job-id="1" data-job-title="Python Developer" data-company="Tech Corp">View Details</button>
                                    <a href="#" class="btn btn-sm btn-primary flex-grow-1 apply-job-btn btn-hover-ripple" data-job-id="1" data-job-title="Python Developer">Apply</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ========== APPLIED JOBS PAGE ========== -->
            <div id="page-applied-jobs" class="dashboard-page">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="fas fa-file-alt me-2"></i>Applied Jobs</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover align-middle">
                                <thead>
                                    <tr>
                                        <th>Job Title</th>
                                        <th>Company</th>
                                        <th>Applied Date</th>
                                        <th>Status</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Software Engineer</td>
                                        <td>Tech Corp</td>
                                        <td>16 Jan 2024</td>
                                        <td><span class="badge badge-applied"><i class="fas fa-paper-plane"></i> Applied</span></td>
                                        <td><button class="btn btn-sm btn-outline-primary view-application-details btn-hover-ripple" data-job-title="Software Engineer" data-company="Tech Corp" data-status="Applied">View Details</button></td>
                                    </tr>
                                    <tr>
                                        <td>Frontend Developer</td>
                                        <td>Innovate Ltd</td>
                                        <td>21 Jan 2024</td>
                                        <td><span class="badge badge-pending"><i class="fas fa-clock"></i> Under Review</span></td>
                                        <td><button class="btn btn-sm btn-outline-primary view-application-details btn-hover-ripple" data-job-title="Frontend Developer" data-company="Innovate Ltd" data-status="Under Review">View Details</button></td>
                                    </tr>
                                    <tr>
                                        <td>Backend Developer</td>
                                        <td>Cloud Solutions</td>
                                        <td>19 Jan 2024</td>
                                        <td><span class="badge badge-pending"><i class="fas fa-search"></i> Under Review</span></td>
                                        <td><button class="btn btn-sm btn-outline-primary view-application-details btn-hover-ripple" data-job-title="Backend Developer" data-company="Cloud Solutions" data-status="Under Review">View Details</button></td>
                                    </tr>
                                    <tr>
                                        <td>Python Developer</td>
                                        <td>Data Labs</td>
                                        <td>22 Jan 2024</td>
                                        <td><span class="badge badge-selected"><i class="fas fa-check-circle"></i> Selected</span></td>
                                        <td><button class="btn btn-sm btn-outline-primary view-application-details btn-hover-ripple" data-job-title="Python Developer" data-company="Data Labs" data-status="Selected">View Details</button></td>
                                    </tr>
                                    <tr>
                                        <td>Full Stack Developer</td>
                                        <td>Digital Innovations</td>
                                        <td>18 Jan 2024</td>
                                        <td><span class="badge badge-rejected"><i class="fas fa-times-circle"></i> Rejected</span></td>
                                        <td><button class="btn btn-sm btn-outline-primary view-application-details btn-hover-ripple" data-job-title="Full Stack Developer" data-company="Digital Innovations" data-status="Rejected">View Details</button></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
<!-- ========== SHORTLISTED COMPANIES PAGE ========== -->
<div id="page-shortlisted-companies" class="dashboard-page">
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0">
          <i class="fas fa-calendar-check me-2"></i>Shortlisted Companies
        </h5>
      </div>
      <div class="card-body">
        <p class="text-muted mb-4">
          Companies where you are shortlisted for interviews.
        </p>
  
        <div class="table-responsive">
          <table class="table table-hover align-middle">
            <thead>
              <tr>
                <th>Company Name</th>
                <th>Job Requirement</th>
                <th>Interview Date & Time</th>
                <th>Interview Mode</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Innovate Ltd</td>
                <td>Frontend Developer</td>
                <td>28 Jan 2024, 10:00 AM</td>
                <td>
                  <span class="badge badge-info">
                    <i class="fas fa-video me-1"></i>Online
                  </span>
                </td>
                <td>
                  <span class="badge badge-pending">
                    <i class="fas fa-clock me-1"></i>Interview Scheduled
                  </span>
                </td>
              </tr>
  
              <tr>
                <td>Tech Corp</td>
                <td>Software Engineer</td>
                <td>30 Jan 2024, 11:30 AM</td>
                <td>
                  <span class="badge badge-primary">
                    <i class="fas fa-building me-1"></i>Offline
                  </span>
                </td>
                <td>
                  <span class="badge badge-applied">
                    <i class="fas fa-check me-1"></i>Shortlisted
                  </span>
                </td>
              </tr>
  
              <tr>
                <td>Data Labs</td>
                <td>Python Developer</td>
                <td>—</td>
                <td>—</td>
                <td>
                  <span class="badge badge-selected">
                    <i class="fas fa-check-circle me-1"></i>Selected
                  </span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
  
      </div>
    </div>
  </div>
  
            <!-- ========== SELECTED COMPANIES PAGE ========== -->
            <div id="page-selected-companies" class="dashboard-page">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="fas fa-check-circle me-2"></i>Selected Companies</h5>
                    </div>
                    <div class="card-body">
                        <p class="text-muted mb-4">Companies where you have been selected (offer received).</p>
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item selected-company-item d-flex justify-content-between align-items-center">
                                <div>
                                    <strong>Data Labs</strong><br>
                                    <small class="text-muted">Python Developer — Offer received on 25 Jan 2024</small>
                                </div>
                                <span class="badge badge-selected"><i class="fas fa-check-circle"></i> Selected</span>
                            </li>
                            <li class="list-group-item">
                                <small class="text-muted">No other selections yet. Keep applying!</small>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

           <!-- ========== PLACEMENT CELL CONTACT PAGE ========== -->
<div id="page-placement-contact" class="dashboard-page">
    <div class="card mb-4">
      <div class="card-header">
        <h5 class="mb-0">
          <i class="fas fa-address-card me-2"></i>Placement Cell Contact
        </h5>
      </div>
      <div class="card-body">
  
        <!-- CONTACT INFO -->
        <div class="row">
          <div class="col-md-6 mb-4">
            <h6 class="text-primary mb-3">
              <i class="fas fa-map-marker-alt me-2"></i>Address
            </h6>
            <p class="mb-0">
              Placement Cell Office<br>
              College Campus<br>
              City, State - 123456<br>
              India
            </p>
          </div>
  
          <div class="col-md-6 mb-4">
            <h6 class="text-primary mb-3">
              <i class="fas fa-phone me-2"></i>Phone
            </h6>
            <p class="mb-0">
              <strong>Office:</strong> +91 123 456 7890<br>
              <strong>Mobile:</strong> +91 98765 43210
            </p>
          </div>
  
          <div class="col-md-6 mb-4">
            <h6 class="text-primary mb-3">
              <i class="fas fa-envelope me-2"></i>Email
            </h6>
            <p class="mb-0">
              <strong>General:</strong> placement@college.edu<br>
              <strong>Students:</strong> students@placement.college.edu
            </p>
          </div>
  
          <div class="col-md-6 mb-4">
            <h6 class="text-primary mb-3">
              <i class="fas fa-clock me-2"></i>Office Hours
            </h6>
            <p class="mb-0">
              Monday – Friday: 9:00 AM – 5:00 PM<br>
              Saturday: 9:00 AM – 1:00 PM
            </p>
          </div>
        </div>
  
        <!-- CONTACT FORM -->
        <div class="row mt-4">
          <div class="col-lg-8">
            <div class="card">
              <div class="card-header">
                <h5 class="mb-0">
                  <i class="fas fa-paper-plane me-2"></i>Send Message to Placement Cell
                </h5>
              </div>
              <div class="card-body">
                <form id="placementContactForm">
  
                  <div class="row">
                    <div class="col-md-6 mb-3">
                      <label class="form-label">
                        Your Name <span class="text-danger">*</span>
                      </label>
                      <input type="text" class="form-control" placeholder="Enter your name" required>
                    </div>
  
                    <div class="col-md-6 mb-3">
                      <label class="form-label">
                        Email Address <span class="text-danger">*</span>
                      </label>
                      <input type="email" class="form-control" placeholder="Enter your email" required>
                    </div>
                  </div>
  
                  <div class="row">
                    <div class="col-md-6 mb-3">
                      <label class="form-label">Phone Number</label>
                      <input type="tel" class="form-control" placeholder="Enter your phone number">
                    </div>
  
                    <div class="col-md-6 mb-3">
                      <label class="form-label">
                        Subject <span class="text-danger">*</span>
                      </label>
                      <select class="form-select" required>
                        <option value="">Select subject</option>
                        <option>Placement Query</option>
                        <option>Interview Issue</option>
                        <option>Company Related</option>
                        <option>General Query</option>
                      </select>
                    </div>
                  </div>
  
                  <div class="mb-3">
                    <label class="form-label">
                      Message <span class="text-danger">*</span>
                    </label>
                    <textarea class="form-control" rows="4"
                      placeholder="Write your message..." required></textarea>
                  </div>
  
                  <button type="submit" class="btn btn-primary">
                    <i class="fas fa-paper-plane me-2"></i>Send Message
                  </button>
  
                </form>
              </div>
            </div>
          </div>
        </div>
  
      </div>
    </div>
  </div>
  
        </main>
    </div>

    

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JS -->
    <script src="{% static 'js/main.js' %}"></script>
    
    <script>

            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', runAutofill);
            } else {
                requestAnimationFrame(runAutofill);
            }

            var pageTitles = {
                'page-dashboard': 'Dashboard',
                'page-personal-details': 'Update Personal Details',
                'page-job-listings': 'New Job Listings',
                'page-applied-jobs': 'Applied Jobs',
                'page-shortlisted-companies': 'Shortlisted Companies',
                'page-selected-companies': 'Selected Companies',
                'page-placement-contact': 'Placement Cell Contact'
            };

            function showPage(pageId) {
                document.querySelectorAll('.dashboard-page').forEach(function(el) {
                    el.classList.remove('active');
                });
                var page = document.getElementById(pageId);
                if (page) {
                    page.classList.add('active');
                }
                var titleEl = document.getElementById('page-title');
                if (titleEl) {
                    titleEl.textContent = pageTitles[pageId] || 'Dashboard';
                }
                document.querySelectorAll('.sidebar-menu .nav-link-dashboard').forEach(function(link) {
                    link.classList.remove('active');
                    if (link.getAttribute('data-page') === pageId) {
                        link.classList.add('active');
                    }
                });
            }

            document.querySelectorAll('.nav-link-dashboard').forEach(function(link) {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    var pageId = this.getAttribute('data-page');
                    if (pageId) {
                        showPage(pageId);
                        if (pageId === 'page-personal-details') {
                            var p = loadStudentProfile();
                            if (p) prefillPersonalDetailsForm(p);
                        }
                    }
                });
            });

            // Job role filter
            var filterEl = document.getElementById('jobRoleFilter');
            if (filterEl) {
                filterEl.addEventListener('change', function() {
                    var role = this.value;
                    document.querySelectorAll('.job-card-item').forEach(function(card) {
                        var show = !role || card.getAttribute('data-role') === role;
                        card.style.display = show ? '' : 'none';
                    });
                });
            }

            // File drop zone (PDF only)
            var resumeDropZone = document.getElementById('resumeDropZone');
            var resumeUpload = document.getElementById('resumeUpload');
            var resumeFileName = document.getElementById('resumeFileName');
            if (resumeDropZone && resumeUpload) {
                resumeDropZone.addEventListener('click', function(e) {
                    if (e.target !== resumeUpload) resumeUpload.click();
                });
                resumeDropZone.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    resumeDropZone.classList.add('drag-over');
                });
                resumeDropZone.addEventListener('dragleave', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    resumeDropZone.classList.remove('drag-over');
                });
                resumeDropZone.addEventListener('drop', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    resumeDropZone.classList.remove('drag-over');
                    var files = e.dataTransfer && e.dataTransfer.files;
                    if (files && files.length) handleResumeFile(files[0]);
                });
                resumeUpload.addEventListener('change', function() {
                    var file = this.files && this.files[0];
                    if (file) handleResumeFile(file);
                });
                function handleResumeFile(file) {
                    var isPdf = file.type === 'application/pdf' || (file.name && file.name.toLowerCase().endsWith('.pdf'));
                    var maxSize = 2 * 1024 * 1024;
                    resumeDropZone.classList.remove('is-invalid', 'has-file');
                    if (!isPdf) {
                        resumeDropZone.classList.add('is-invalid');
                        if (typeof showToast === 'function') showToast('Please upload a PDF file only.', 'danger');
                        resumeUpload.value = '';
                        resumeFileName.textContent = '';
                        return;
                    }
                    if (file.size > maxSize) {
                        resumeDropZone.classList.add('is-invalid');
                        if (typeof showToast === 'function') showToast('File must be 2MB or less.', 'danger');
                        resumeUpload.value = '';
                        resumeFileName.textContent = '';
                        return;
                    }
                    resumeDropZone.classList.add('has-file');
                    resumeFileName.textContent = file.name;
                }
            }

            // Passport photo preview
            var passportPhotoInput = document.getElementById('studentPassportPhoto');
            var passportPhotoImg = document.getElementById('passportPhotoImg');
            var passportPhotoPlaceholder = document.getElementById('passportPhotoPlaceholder');
            if (passportPhotoInput && passportPhotoImg && passportPhotoPlaceholder) {
                passportPhotoInput.addEventListener('change', function() {
                    var file = this.files && this.files[0];
                    if (file && (file.type === 'image/jpeg' || file.type === 'image/jpg' || file.type === 'image/png')) {
                        if (file.size > 500 * 1024) {
                            if (typeof showToast === 'function') showToast('Photo must be 500KB or less.', 'danger');
                            this.value = '';
                            return;
                        }
                        var reader = new FileReader();
                        reader.onload = function() {
                            passportPhotoImg.src = reader.result;
                            passportPhotoImg.style.display = 'block';
                            passportPhotoPlaceholder.style.display = 'none';
                        };
                        reader.readAsDataURL(file);
                    } else if (!file) {
                        passportPhotoImg.src = '';
                        passportPhotoImg.style.display = 'none';
                        passportPhotoPlaceholder.style.display = 'block';
                    } else {
                        if (typeof showToast === 'function') showToast('Please select JPG or PNG image.', 'danger');
                        this.value = '';
                    }
                });
            }

            
            // View Job Details Modal
            document.querySelectorAll('.view-job-details').forEach(function(btn) {
                btn.addEventListener('click', function() {
                    var jobTitle = this.getAttribute('data-job-title');
                    var company = this.getAttribute('data-company');
                    var jobId = this.getAttribute('data-job-id');
                    
                    var jobDetails = {
                        1: { title: 'Python Developer', company: 'Tech Corp', type: 'Full Time', salary: '8-12 LPA', location: 'Bangalore', skills: 'Python, SQL, Django', eligibility: 'CGPA ≥ 7.5, Python, SQL', description: 'We are looking for a skilled Python Developer to join our team.' },
                        2: { title: 'Java Backend Developer', company: 'Innovate Ltd', type: 'Full Time', salary: '7-11 LPA', location: 'Mumbai', skills: 'Java, Spring, Hibernate', eligibility: 'CGPA ≥ 7.0, Java, Spring', description: 'Join our backend team to build scalable applications.' },
                        3: { title: 'Web Developer (React)', company: 'Cloud Solutions', type: 'Full Time', salary: '6-10 LPA', location: 'Hyderabad', skills: 'HTML/CSS, JavaScript, React', eligibility: 'CGPA ≥ 7.0, HTML/CSS, JavaScript, React', description: 'Frontend developer position focusing on React applications.' }
                    };
                    
                    var details = jobDetails[jobId] || { title: jobTitle, company: company, type: 'Full Time', salary: 'Competitive', location: 'Multiple', skills: 'Various', eligibility: 'As per requirements', description: 'Job details available upon application.' };
                    
                    document.getElementById('jobDetailsTitle').textContent = details.title;
                    document.getElementById('jobDetailsCompany').textContent = details.company;
                    document.getElementById('jobDetailsType').textContent = details.type;
                    document.getElementById('jobDetailsSalary').textContent = details.salary;
                    document.getElementById('jobDetailsLocation').textContent = details.location;
                    document.getElementById('jobDetailsSkills').textContent = details.skills;
                    document.getElementById('jobDetailsEligibility').textContent = details.eligibility;
                    document.getElementById('jobDetailsDescription').textContent = details.description;
                    
                    var modal = new bootstrap.Modal(document.getElementById('jobDetailsModal'));
                    modal.show();
                });
            });

            // Apply Job Confirmation
            document.querySelectorAll('.apply-job-btn').forEach(function(btn) {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    var jobTitle = this.getAttribute('data-job-title');
                    document.getElementById('confirmJobTitle').textContent = jobTitle;
                    var modal = new bootstrap.Modal(document.getElementById('applyJobModal'));
                    modal.show();
                });
            });

            // Confirm Apply (with loading spinner)
            document.getElementById('confirmApplyBtn').addEventListener('click', function() {
                var btn = this;
                if (btn.classList.contains('btn-loading')) return;
                btn.classList.add('btn-loading');
                btn.disabled = true;
                var originalHtml = btn.innerHTML;
                btn.innerHTML = '<span class="btn-spinner" aria-hidden="true"></span> Submitting...';
                setTimeout(function() {
                    btn.classList.remove('btn-loading');
                    btn.disabled = false;
                    btn.innerHTML = originalHtml;
                    if (typeof showToast === 'function') {
                        showToast('Application Submitted', 'success');
                    } else {
                        alert('Application Submitted');
                    }
                    bootstrap.Modal.getInstance(document.getElementById('applyJobModal')).hide();
                }, 1500);
            });

            // View Application Details
            document.querySelectorAll('.view-application-details').forEach(function(btn) {
                btn.addEventListener('click', function() {
                    var jobTitle = this.getAttribute('data-job-title');
                    var company = this.getAttribute('data-company');
                    var status = this.getAttribute('data-status');
                    
                    document.getElementById('applicationJobTitle').textContent = jobTitle;
                    document.getElementById('applicationCompany').textContent = company;
                    document.getElementById('applicationStatus').textContent = status;
                    var statusClass = status === 'Selected' ? 'badge-selected' : status === 'Rejected' ? 'badge-rejected' : status === 'Under Review' ? 'badge-pending' : 'badge-applied';
                    var statusIcon = status === 'Selected' ? 'fa-check-circle' : status === 'Rejected' ? 'fa-times-circle' : status === 'Under Review' ? 'fa-clock' : 'fa-paper-plane';
                    var el = document.getElementById('applicationStatus');
                    el.className = 'badge ' + statusClass;
                    el.innerHTML = '<i class="fas ' + statusIcon + '"></i> ' + status;
                    
                    var modal = new bootstrap.Modal(document.getElementById('applicationDetailsModal'));
                    modal.show();
                });
            });
        })();
    </script>

    <!-- Job Details Modal -->
    <div class="modal fade" id="jobDetailsModal" tabindex="-1" aria-labelledby="jobDetailsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="jobDetailsModalLabel"><i class="fas fa-briefcase me-2"></i>Job Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <h4 id="jobDetailsTitle" class="mb-3"></h4>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <p><strong><i class="fas fa-building me-2 text-primary"></i>Company:</strong> <span id="jobDetailsCompany"></span></p>
                            <p><strong><i class="fas fa-briefcase me-2 text-primary"></i>Job Type:</strong> <span id="jobDetailsType"></span></p>
                            <p><strong><i class="fas fa-rupee-sign me-2 text-primary"></i>Salary:</strong> <span id="jobDetailsSalary"></span></p>
                        </div>
                        <div class="col-md-6">
                            <p><strong><i class="fas fa-map-marker-alt me-2 text-primary"></i>Location:</strong> <span id="jobDetailsLocation"></span></p>
                            <p><strong><i class="fas fa-code me-2 text-primary"></i>Skills:</strong> <span id="jobDetailsSkills"></span></p>
                            <p><strong><i class="fas fa-check-circle me-2 text-primary"></i>Eligibility:</strong> <span id="jobDetailsEligibility"></span></p>
                        </div>
                    </div>
                    <div class="mb-3">
                        <strong>Description:</strong>
                        <p id="jobDetailsDescription" class="text-muted mt-2"></p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary">Apply Now</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Apply Job Confirmation Modal -->
    <div class="modal fade confirmation-modal" id="applyJobModal" tabindex="-1" aria-labelledby="applyJobModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="applyJobModalLabel"><i class="fas fa-question-circle me-2 text-warning"></i>Confirm Application</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Are you sure you want to apply for <strong id="confirmJobTitle"></strong>?</p>
                    <p class="text-muted small">Please ensure your resume is up to date before submitting.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary btn-hover-ripple" id="confirmApplyBtn">Confirm & Apply</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Application Details Modal -->
    <div class="modal fade" id="applicationDetailsModal" tabindex="-1" aria-labelledby="applicationDetailsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="applicationDetailsModalLabel"><i class="fas fa-file-alt me-2"></i>Application Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <p><strong>Job Title:</strong> <span id="applicationJobTitle"></span></p>
                            <p><strong>Company:</strong> <span id="applicationCompany"></span></p>
                        </div>
                        <div class="col-md-6">
                            <p><strong>Status:</strong> <span id="applicationStatus" class="badge"></span></p>
                            <p><strong>Applied Date:</strong> 16 Jan 2024</p>
                        </div>
                    </div>
                    <div class="alert alert-info">
                        <i class="fas fa-info-circle me-2"></i>Your application is being reviewed. You will be notified of any updates.
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
